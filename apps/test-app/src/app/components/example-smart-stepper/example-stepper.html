<!-- Smart Stepper Section -->
<section class="component-section">
  <h2>Smart Stepper</h2>
  <div class="demo-row">
    <bds-smart-stepper [steps]="steps" [allowInvalidAdvance]="true" [(activeIndex)]="activeIndex"
      [(activeIndexSubStep)]="activeIndexSubStep" [linear]="true" (stepChange)="onStepChange($event)"
      (subStepClick)="onSubStepChange(undefined, $event)">
      <!-- PASO 0 -->
      <ng-template bdsStepContent="0">
        <mat-stepper class="bds-smart-stepper__inner-stepper" (selectionChange)="onSubStepChange($event)"
          [selectedIndex]="activeIndexSubStep" linear #stepper>
          <mat-step [stepControl]="activoFullInfo.get('ubicacionYRegistro')!">
            <ng-template matStepLabel>Ubicacion</ng-template>
            <div class="expansion-panel__container__full-info__expansion-panel__container__full-info__content-tab"
              style="padding: 1rem" [formGroup]="activoFullInfo">
              <ng-container formGroupName="ubicacionYRegistro">
                @for (panel of getUbicacionPanels(); track panel; let first = $first) {
                <mat-expansion-panel class="expansion-panel__full-width" [expanded]="first">
                  <div class="row g-3">
                    @for (field of panel.fields; track field) {
                    <div class="col-12 col-md-6">
                      <bds-form-field class="expansion-panel__container__input" [label]="field.label"
                        [formControlName]="field.name"></bds-form-field>
                    </div>
                    }
                  </div>
                </mat-expansion-panel>
                }
              </ng-container>
            </div>
          </mat-step>
        </mat-stepper>
      </ng-template>
      <ng-template bdsStepContent="1">
        <div class="expansion-panel__container__full-info__expansion-panel__container__full-info__content-tab"
          style="padding: 1rem" [formGroup]="activoFullInfo">
          <ng-container formGroupName="proyectoGestion">
            @for (panel of getProyectoPanels(); track panel; let first = $first) {
            <ng-container [formGroupName]="panel.groupName">
              <mat-expansion-panel class="expansion-panel__full-width" [expanded]="first">
                <div class="row g-3">
                  @for (field of panel.fields; track field) {
                  <div class="col-12 col-md-6">
                    <bds-form-field class="expansion-panel__container__input" [label]="field.label"
                      [formControlName]="field.name"></bds-form-field>
                  </div>
                  }
                </div>
              </mat-expansion-panel>
            </ng-container>
            }
          </ng-container>
        </div>
      </ng-template>
      <ng-template bdsStepContent="2">
        <div class="expansion-panel__container__full-info__expansion-panel__container__full-info__content-tab"
          style="padding: 1rem" [formGroup]="activoFullInfo">
          <ng-container formGroupName="equipoYAvaluo">
            @for (panel of getEquipoPanels(); track panel; let first = $first) {
            <ng-container [formGroupName]="panel.groupName">
              <mat-expansion-panel class="expansion-panel__full-width" [expanded]="first">
                <div class="row g-3">
                  @for (field of panel.fields; track field) {
                  <div class="col-12 col-md-6">
                    <bds-form-field class="expansion-panel__container__input" [label]="field.label"
                      [formControlName]="field.name"></bds-form-field>
                  </div>
                  }
                </div>
              </mat-expansion-panel>
            </ng-container>
            }
          </ng-container>
        </div>
      </ng-template>
      <ng-template bdsStepContent="3">
        <div class="expansion-panel__container__full-info__expansion-panel__container__full-info__content-tab"
          style="padding: 1rem" [formGroup]="activoFullInfo">
          <ng-container formGroupName="redYEstructura">
            @for (panel of getRedPanels(); track panel; let first = $first) {
            <ng-container [formGroupName]="panel.groupName">
              <mat-expansion-panel class="expansion-panel__full-width" [expanded]="first">
                <div class="row g-3">
                  @for (field of panel.fields; track field) {
                  <div class="col-12 col-md-6">
                    <bds-form-field class="expansion-panel__container__input" [label]="field.label"
                      [formControlName]="field.name"></bds-form-field>
                  </div>
                  }
                </div>
              </mat-expansion-panel>
            </ng-container>
            }
          </ng-container>
        </div>
      </ng-template>
    </bds-smart-stepper>
  </div>
</section>
